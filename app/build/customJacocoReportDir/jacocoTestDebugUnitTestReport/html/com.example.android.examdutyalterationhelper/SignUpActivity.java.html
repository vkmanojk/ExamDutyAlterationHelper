<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SignUpActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">com.example.android.examdutyalterationhelper</a> &gt; <span class="el_source">SignUpActivity.java</span></div><h1>SignUpActivity.java</h1><pre class="source lang-java linenums">package com.example.android.examdutyalterationhelper;

import androidx.annotation.NonNull;
import androidx.appcompat.app.AppCompatActivity;

import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.util.Patterns;
import android.view.View;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

import com.google.android.gms.tasks.OnCompleteListener;
import com.google.android.gms.tasks.Task;
import com.google.android.material.floatingactionbutton.FloatingActionButton;
import com.google.firebase.auth.AuthResult;
import com.google.firebase.auth.FirebaseAuth;
import com.google.firebase.auth.FirebaseAuthUserCollisionException;
import com.google.firebase.database.DatabaseReference;
import com.google.firebase.database.FirebaseDatabase;

import java.util.regex.Pattern;

<span class="nc" id="L26">public class SignUpActivity extends AppCompatActivity {</span>

    protected EditText emailEditText,pwdEditText,phoneEditText,nameEditText;
    protected TextView signUpTextView,signInTextView;
    protected FloatingActionButton floatButtonSignUp;
    private FirebaseAuth mAuth;
    private DatabaseReference databaseUsers;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
<span class="nc" id="L36">        super.onCreate(savedInstanceState);</span>
<span class="nc" id="L37">        setContentView(R.layout.activity_sign_up);</span>

<span class="nc" id="L39">        emailEditText = findViewById(R.id.email_signup);</span>
<span class="nc" id="L40">        pwdEditText = findViewById(R.id.pwd_signup);</span>
<span class="nc" id="L41">        phoneEditText = findViewById(R.id.phone_signup);</span>
<span class="nc" id="L42">        nameEditText = findViewById(R.id.name_signup);</span>
<span class="nc" id="L43">        signUpTextView = findViewById(R.id.signup_textview_signuppage);</span>
<span class="nc" id="L44">        signInTextView = findViewById(R.id.signin_textview_signuppage);</span>
<span class="nc" id="L45">        floatButtonSignUp = findViewById(R.id.float_button_signup);</span>

<span class="nc" id="L47">        mAuth = FirebaseAuth.getInstance();</span>
<span class="nc" id="L48">        databaseUsers = FirebaseDatabase.getInstance().getReference(&quot;Users&quot;);</span>

<span class="nc" id="L50">        floatButtonSignUp.setOnClickListener(new View.OnClickListener() {</span>
            @Override
            public void onClick(View v) {
<span class="nc" id="L53">                registerUser();</span>
<span class="nc" id="L54">            }</span>
        });

<span class="nc" id="L57">        signInTextView.setOnClickListener(new View.OnClickListener() {</span>
            @Override
            public void onClick(View v) {
<span class="nc" id="L60">                Intent i = new Intent(SignUpActivity.this,MainActivity.class);</span>
<span class="nc" id="L61">                i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);</span>
<span class="nc" id="L62">                startActivity(i);</span>
<span class="nc" id="L63">            }</span>
        });
<span class="nc" id="L65">    }</span>

    protected static boolean EmailCheck(String email) {
<span class="fc bfc" id="L68" title="All 2 branches covered.">        if(email.isEmpty()){</span>
<span class="fc" id="L69">            return false;</span>
        }
<span class="fc" id="L71">        String emailRegex = &quot;^[a-zA-Z0-9_+&amp;*-]+(?:\\.&quot;+</span>
                &quot;[a-zA-Z0-9_+&amp;*-]+)*@&quot; +
                &quot;(?:[a-zA-Z0-9-]+\\.)+[a-z&quot; +
                &quot;A-Z]{2,7}$&quot;;

<span class="fc" id="L76">        Pattern pat = Pattern.compile(emailRegex);</span>
<span class="fc bfc" id="L77" title="All 2 branches covered.">        if(!(pat.matcher(email).matches())) {</span>
<span class="fc" id="L78">            return false;</span>
        }
<span class="fc" id="L80">        return true;</span>
    }

    protected static boolean NameCheck(String name) {
<span class="fc bfc" id="L84" title="All 4 branches covered.">        if(name.isEmpty() || name.equals(&quot; &quot;)){</span>
<span class="fc" id="L85">            return false;</span>
        }
<span class="fc bfc" id="L87" title="All 2 branches covered.">        if(Pattern.compile( &quot;[0-9]&quot; ).matcher(name).find()) {</span>
<span class="fc" id="L88">            return false;</span>
        }
<span class="fc" id="L90">        return true;</span>
    }

    protected static boolean PwdCheck(String pwd) {
<span class="fc bfc" id="L94" title="All 2 branches covered.">        if(pwd.isEmpty()){</span>
<span class="fc" id="L95">            return false;</span>
        }
<span class="fc bfc" id="L97" title="All 2 branches covered.">        if(pwd.length()&lt;6){;</span>
<span class="fc" id="L98">            return false;</span>
        }
<span class="fc" id="L100">        return true;</span>
    }

    protected static boolean PhoneCheck(String phone) {
<span class="fc bfc" id="L104" title="All 2 branches covered.">        if(phone.isEmpty()){</span>
<span class="fc" id="L105">            return false;</span>
        }
<span class="fc bfc" id="L107" title="All 2 branches covered.">        if(!(phone.length() == 10)){;</span>
<span class="fc" id="L108">            return false;</span>
        }
<span class="pc bpc" id="L110" title="1 of 2 branches missed.">        if(phone.matches(&quot;^[a-zA-Z]*$&quot;)) {</span>
<span class="nc" id="L111">            return false;</span>
        }
<span class="fc" id="L113">        return true;</span>
    }


    protected void registerUser(){
<span class="nc" id="L118">        final String email = emailEditText.getText().toString().trim();</span>
<span class="nc" id="L119">        final String pwd = pwdEditText.getText().toString().trim();</span>
<span class="nc" id="L120">        final String phone = phoneEditText.getText().toString().trim();</span>
<span class="nc" id="L121">        final String name = nameEditText.getText().toString().trim();</span>

<span class="nc bnc" id="L123" title="All 2 branches missed.">        if(name.isEmpty()){</span>
<span class="nc" id="L124">            nameEditText.setError(&quot;Name Is Required&quot;);</span>
<span class="nc" id="L125">            nameEditText.requestFocus();</span>
<span class="nc" id="L126">            return;</span>
        }

<span class="nc bnc" id="L129" title="All 2 branches missed.">        if(Pattern.compile( &quot;[0-9]&quot; ).matcher(name).find()) {</span>
<span class="nc" id="L130">            nameEditText.setError(&quot;Enter a Valid Name&quot;);</span>
<span class="nc" id="L131">            nameEditText.requestFocus();</span>
<span class="nc" id="L132">            return;</span>
        }

<span class="nc bnc" id="L135" title="All 2 branches missed.">        if(email.isEmpty()){</span>
<span class="nc" id="L136">            emailEditText.setError(&quot;Email Is Required&quot;);</span>
<span class="nc" id="L137">            emailEditText.requestFocus();</span>
<span class="nc" id="L138">            return;</span>
        }

<span class="nc bnc" id="L141" title="All 2 branches missed.">        if(!Patterns.EMAIL_ADDRESS.matcher(email).matches()){</span>
<span class="nc" id="L142">            emailEditText.setError(&quot;Enter A Valid Email Address&quot;);</span>
<span class="nc" id="L143">            emailEditText.requestFocus();</span>
<span class="nc" id="L144">            return;</span>
        }

<span class="nc bnc" id="L147" title="All 2 branches missed.">        if(pwd.isEmpty()){</span>
<span class="nc" id="L148">            pwdEditText.setError(&quot;Password Is Required&quot;);</span>
<span class="nc" id="L149">            pwdEditText.requestFocus();</span>
<span class="nc" id="L150">            return;</span>
        }
<span class="nc bnc" id="L152" title="All 2 branches missed.">        if(pwd.length()&lt;6){</span>
<span class="nc" id="L153">            pwdEditText.setError(&quot;Password Should Be At Least 6 Characters&quot;);</span>
<span class="nc" id="L154">            pwdEditText.requestFocus();</span>
<span class="nc" id="L155">            return;</span>
        }

<span class="nc bnc" id="L158" title="All 2 branches missed.">        if(phone.isEmpty()){</span>
<span class="nc" id="L159">            phoneEditText.setError(&quot;Phone Number Is Required&quot;);</span>
<span class="nc" id="L160">            phoneEditText.requestFocus();</span>
<span class="nc" id="L161">            return;</span>
        }
<span class="nc bnc" id="L163" title="All 2 branches missed.">        if(!(phone.length()==10)){</span>
<span class="nc" id="L164">            pwdEditText.setError(&quot;Phone Number Should Contain Only 10 Digits&quot;);</span>
<span class="nc" id="L165">            pwdEditText.requestFocus();</span>
<span class="nc" id="L166">            return;</span>
        }
<span class="nc bnc" id="L168" title="All 2 branches missed.">        if(phone.matches(&quot;^[a-zA-Z]*$&quot;)) {</span>
<span class="nc" id="L169">            phoneEditText.setError(&quot;Phone Number should contain only digits&quot;);</span>
<span class="nc" id="L170">            phoneEditText.requestFocus();</span>
<span class="nc" id="L171">            return;</span>
        }

<span class="nc" id="L174">        mAuth.createUserWithEmailAndPassword(email,pwd).addOnCompleteListener(new OnCompleteListener&lt;AuthResult&gt;() {</span>
            @Override
            public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {
<span class="nc bnc" id="L177" title="All 2 branches missed.">                if(task.isSuccessful()){</span>
<span class="nc" id="L178">                    mAuth.getCurrentUser().sendEmailVerification().addOnCompleteListener(new OnCompleteListener&lt;Void&gt;() {</span>
                        @Override
                        public void onComplete(@NonNull Task&lt;Void&gt; task) {
<span class="nc bnc" id="L181" title="All 2 branches missed.">                            if(task.isSuccessful()){</span>
<span class="nc" id="L182">                                Users user = new Users(name,phone,email);</span>
<span class="nc" id="L183">                                String e = email.split(&quot;@&quot;)[0];</span>
<span class="nc" id="L184">                                databaseUsers.child(e).setValue(user).addOnCompleteListener(new OnCompleteListener&lt;Void&gt;() {</span>
                                    @Override
                                    public void onComplete(@NonNull Task&lt;Void&gt; task) {
<span class="nc bnc" id="L187" title="All 2 branches missed.">                                        if(task.isSuccessful()){</span>
<span class="nc" id="L188">                                            Toast.makeText(getApplicationContext(),&quot;Registration Successful! Please Verify Your Email&quot;,Toast.LENGTH_LONG).show();</span>

<span class="nc" id="L190">                                            Intent i = new Intent(SignUpActivity.this,MainActivity.class);</span>
<span class="nc" id="L191">                                            i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);</span>
<span class="nc" id="L192">                                            startActivity(i);</span>
<span class="nc" id="L193">                                        }else{</span>
<span class="nc" id="L194">                                            Toast.makeText(getApplicationContext(),&quot;Registration Unsuccessful&quot;,Toast.LENGTH_LONG).show();</span>
                                        }
<span class="nc" id="L196">                                    }</span>
                                });
                            }
<span class="nc" id="L199">                        }</span>
                    });

                }else{
<span class="nc bnc" id="L203" title="All 2 branches missed.">                    if(task.getException() instanceof FirebaseAuthUserCollisionException){</span>
<span class="nc" id="L204">                        Toast.makeText(getApplicationContext(),&quot;User Already Exists! Try With A New Email&quot;,Toast.LENGTH_LONG).show();</span>
                    }else{
<span class="nc" id="L206">                        Toast.makeText(getApplicationContext(),&quot;Registration Unsuccessful! Try Again&quot;,Toast.LENGTH_LONG).show();</span>
                    }
                }
<span class="nc" id="L209">            }</span>
        });
<span class="nc" id="L211">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>